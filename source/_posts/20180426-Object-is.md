---
title: Object.is()
date: 2018-04-26 12:25:15
tags: [ES6, Objectï¼Œ Jest, infinity]
category: ES6
---

å‰å‡ å¤©å†™æµ‹è¯•çš„æ—¶å€™ï¼Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ£€æŸ¥ Object çš„ reference æ˜¯å¦æ”¹å˜ï¼Œjest ä¸­çš„`toEqual(value)`æ˜¯ deep compareï¼Œä¸é€‚ç”¨äº referenceï¼Œäºæ˜¯æŸ¥çœ‹äº†ä¸€ä¸‹åº”è¯¥ä½¿ç”¨`toBe(value)`ã€‚

> `toBe` just checks that a value is what you expect. It uses `Object.is` to check exact equality.[^1]

ä»¥å‰æ²¡è§è¿‡ä¹Ÿæ²¡ç”¨è¿‡`Object.is`ï¼ŒæŸ¥äº†ä¸€ä¸‹å‘ç°æ˜¯ ES6 çš„æ–°è¯­æ³•[^2]

### `Object.is(val1, val2)`

`Object.is`æ–¹æ³•ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒï¼Œä¸`==`å’Œ`===`æ˜¯æœ‰ä¸€å®šåŒºåˆ«çš„

åœ¨ä½¿ç”¨`==`æ—¶ï¼Œå¦‚æœç­‰å·ä¸¤è¾¹ç±»å‹ä¸åŒï¼Œjs ä¼šå…ˆè¿›è¡Œç±»å‹è½¬æ¢ï¼Œå†è¿›è¡Œå€¼çš„æ¯”è¾ƒã€‚
è€Œä½¿ç”¨`===`æ—¶ï¼Œåªè¦ç±»å‹ä¸åŒå°±ä¸º false
`Object.is`åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç­‰åŒäº`===`ï¼Œä½†æœ‰ä¸¤ç§æƒ…å†µé™¤å¤–

- `+0` / `-0`
  - `===` æ— æ³•åŒºåˆ† `+0`å’Œ`-0`
  - `Object.is(+0, -0)` è¿”å›`false` å¯ä»¥åŒºåˆ†
- `NaN`
  - æ— æ³•ç”¨`===`æ¥è¿›è¡Œæ£€æŸ¥ï¼Œéœ€è¦ä½¿ç”¨`isNaN()`æ–¹æ³•
  - ä½†ç°åœ¨ä¹Ÿå¯ä»¥ç”¨`Object.is(NaN, NaN)`æ¥æ£€æŸ¥

### Magic JS

åŸæ¥é™¤äº†`0.1+0.2=0.00000000000034`è¿™æ ·çš„ï¼Œè¿˜æœ‰å…¶ä»–æç¬‘çš„äº‹æƒ…å­˜åœ¨ï¼Œå¯èƒ½è¿™å°±æ˜¯ that's why I love jsï¼Ÿå†™çš„ä¸å¥½çš„æ—¶å€™å°±å¯ä»¥ blame æ˜¯ JS è¾£é¸¡çš„åŸå› ï¼Œå“ˆå“ˆ

```javascript
1 === 1;
// true
+0 === -0;
// true
1 / +0 === 1 / -0;
// false
```

### Infinity [^4]

`Infinity`æ˜¯æ¯”ä»»ä½•æ•°éƒ½å¤§çš„**æ•°**ï¼Œ åœ¨è¿ç®—ä¸Šä¸æ•°å­¦ä¸Šçš„ Inf ä¸€æ ·
éœ€è¦æ³¨æ„ï¼š

- `Infinity / Infinity` -> `NaN`
- `Number.POSITIVE_INFINITY`
- `Number.NEGATIVE_INFINITY`

### Number.MAX_SAFE_INTEGER [^5]

æœ¬æ¥åªæ˜¯æƒ³ç ”ç©¶ä¸€ä¸‹`Object.is`çš„ï¼Œæ²¡æƒ³åˆ°é¡ºå¸¦å°±åˆå¼•ç”³å‡ºäº†è¿™ä¹ˆå¤šå…¶ä»–çš„ä¸œè¥¿â€¦ä¸Šé¢æåˆ°`Infinity`ï¼Œå¾ˆå®¹æ˜“è”æƒ³åˆ°é‚£ä¹ˆ JS ä¸­æœ€å¤§çš„æ•°æ˜¯å¤šå¤§å‘¢
JS ä¸­æœ‰`Number.MAX_SAFE_INTEGER`ï¼Œå…¶å€¼ä¸º`2^53 - 1`ï¼Œå¯¹åº”çš„æœ€å°æ•°`Number.MIN_SAFE_INTEGER`ï¼Œå…¶å€¼ä¸º`-(2^53 - 1)` åªæœ‰åœ¨è¿™ä¸ªèŒƒå›´å†…çš„æ•°æ‰èƒ½ä¿è¯ä¸€å®šæ˜¯æ­£ç¡®çš„ã€‚

è¶…å‡ºèŒƒå›´çš„æ•°å¯èƒ½ç”±äºç²¾åº¦ä¸¢å¤±è¿˜æ˜¯ä»€ä¹ˆåˆ«çš„åŸå› ï¼Œä¸ä¸€å®šæ­£ç¡®ï¼Œå…¸å‹çš„ä¾‹å­ï¼š

```javascript
Number.MAX_SAFE_INTEGER + 1 === Number.MAX_SAFE_INTEGER + 2; // true
```

ğŸ™„

[^1]: https://facebook.github.io/jest/docs/en/expect.html#tobevalue
[^2]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is
[^3]: https://stackoverflow.com/questions/7223359/are-0-and-0-the-same
[^4]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity
[^5]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER
