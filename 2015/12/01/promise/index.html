<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    æˆ‘æ‰€ç†è§£çš„Promise | å°ç™½å¦¹å¦¹å†™ä»£ç 
  </title>
  <meta name="description" content="JavaScriptæ˜¯ä¸–ç•Œä¸Šç¬¬äºŒå¥½çš„è¯­è¨€ğŸ˜">
  
  <meta name="keywords" content="
  promise
  ">
  
  <meta name="author" content="HiiTea">

  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="theme-color" content="#1e2327">
  <link rel="apple-touch-icon" href="https://github.githubassets.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://github.githubassets.com/apple-touch-icon-180x180.png">

  <link rel="icon" type="image/x-icon" href="https://github.githubassets.com/favicon.ico">
  <link rel="stylesheet" href="/tech/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52574938-4', 'auto');
  ga('send', 'pageview');
</script>


  
<script>
  var _hmt = _hmt || [];
  (function(){var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?d8749b933af749e1e5ec931bb403628f";
    var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
</head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/tech/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div>
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/tech/archives">Archives</a></li>
        
        
        <li><a href="/tech/categories">Categories</a></li>
        
        
        <li><a href="/tech/tags">Tags</a></li>
        
        
        <li class="desktop-only"><a href="/tech/atom.xml" target="_blank">RSS</a></li>
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="https://avatars2.githubusercontent.com/u/5300359?v=4&amp;s=460"> <i class="fa fa-caret-down"></i></i></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/tech/archives" class="header-toolbar-left"><i
                  class="fa fa-file-text"></i> Posts </a>
        <a href="/tech/archives"
           class="header-toolbar-right"> 58 </a>
      </li>
      <li>
        <a href="/tech/tags" class="header-toolbar-left"><i
                  class="fa fa-tags"></i> Tags </a>
        <a href="/tech/tags"
           class="header-toolbar-right"> 166 </a>
      </li>
      <li>
        <a href="/tech/categories" class="header-toolbar-left"><i
                  class="fa fa-folder-open"></i> Categories </a>
        <a href="/tech/categories"
           class="header-toolbar-right"> 23 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/tech/">å°ç™½å¦¹å¦¹å†™ä»£ç </a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    HiiTea

    <span class="post-date float-right" title="{{moment(1448966786000).format('MMM DD, YYYY, h:mm:ss A')}}">
      
          <i class="fa fa-pencil-square-o"></i>
      
      {{moment(1448966786000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1>æˆ‘æ‰€ç†è§£çš„Promise</h1>
    <p>ï¼ˆå«Œæˆ‘è¯å¤šçš„å¯ä»¥ç›´æ¥çœ‹åˆ†å‰²çº¿ä¹‹åçš„éƒ¨åˆ†â€¦ï¼‰<br>ä»¥å‰é«˜ä¸­çš„æ—¶å€™è‡ªå·±æ£è…¾åšå®¢ï¼Œä¸€ç›´ä¹Ÿå°±åªä¼šç”¨JQueryå†™ç‚¹æŒ‰é’®äº‹ä»¶ä»€ä¹ˆçš„ï¼Œè¿è¡¨å•æäº¤éƒ½æ²¡å†™è¿‡ï¼Œåæ¥è¯¯æ‰“è¯¯æ’åšäº†å‰ç«¯ç å†œæ—§è§‰å¾—JSçš„å¼‚æ­¥æ¨¡å¼å®åœ¨æ˜¯å¤ªå‘çˆ¹ï¼Œå½“ä½ ææ¸…æ¥šå¼‚æ­¥å›è°ƒçš„æ—¶å€™ï¼Œåˆä¼šå‘ç°<a href="http://callbackhell.com/" target="_blank" rel="noopener">å›è°ƒåœ°ç‹±(Callback Hell)</a>å¤ªå‘çˆ¹â€¦<br>ä¸ºä»€ä¹ˆè§‰å¾—å¼‚æ­¥å‘çˆ¹ï¼Ÿçœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»¥ä¸‹ç”¨setTimeout()æ¨¡æ‹Ÿä¸€ä¸ªè¯·æ±‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"å°ç™½å¦¹å¦¹"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greeting</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"ä½ å¥½ï¼Œ"</span> + name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆä¸€ä¸ª0åˆ°1000çš„éšæœºæ•°ï¼Œæ¨¡æ‹Ÿä¸ç¡®å®šçš„ç­‰å¾…æ—¶é—´0-1ç§’</span></span><br><span class="line"><span class="keyword">var</span> randomTime = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() * <span class="number">1000</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">""</span>;</span><br><span class="line"><span class="comment">//1ç§’ä¹‹å†…ç»™nameèµ‹å€¼ä¸º å°ç™½å¦¹å¦¹ï¼Œä½†ä¸çŸ¥é“å…·ä½“æ—¶é—´</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  name = getName();</span><br><span class="line">&#125;, randomTime());</span><br><span class="line"></span><br><span class="line">greeting(name); <span class="comment">//ä»¥ä¸ºå¾—åˆ°nameä¹‹åå°±å¯ä»¥å¼€å¿ƒçš„å»æ‰“æ‹›å‘¼å•¦ï¼Œç„¶è€Œâ€¦</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼"><a href="#è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼" class="headerlink" title="è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼"></a>è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼è¿™æ˜¯é”™çš„ï¼</h3><p>å¯èƒ½å¾ˆå¤šæ–°æ‰‹éƒ½çŠ¯è¿‡è¿™ä¸ªé”™è¯¯ï¼Œé”™çš„æ—¶å€™è¿˜ä¸çŸ¥é“ä¸ºå•¥é”™äº†â€¦æ·±ç©¶åŸå› çš„è¯è·ŸJSçš„æœºåˆ¶æœ‰å…³ï¼Œé•¿ç¯‡å¤§è®ºçš„å°±ä¸åœ¨è¿™é‡Œå¤šè¯´äº†ï¼ˆå…¶å®æ˜¯æˆ‘è¯´ä¸æ¸…æ¥šâ€¦ï¼‰</p>
<p>å†æœ‰ç‚¹ç»éªŒï¼Œå°±ä¼šçŸ¥é“ï¼Œåº”è¯¥æŠŠ <code>greeting(name)</code> å†™åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œè¿™æ ·å°±èƒ½ä¿è¯åœ¨å¾—åˆ°æ•°æ®ä¹‹åæ‰è¿è¡Œ <code>greeting()</code> å‡½æ•°ï¼Œäºæ˜¯â€¦å½“ä½ æœ‰å¤šä¸ªè¯·æ±‚å¹¶ä¸”ä¹‹é—´æ˜¯æœ‰è¿™ç§ä¾èµ–å…³ç³»çš„æ—¶å€™ï¼Œå¯æ€•çš„å›è°ƒåœ°ç‹±å°±å‡ºç°äº†ï¼<br>è€Œè§£å†³å›è°ƒåœ°ç‹±å…¶ä¸­ä¸€ä¸ªå¾ˆä¼˜é›…çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ä¼ è¯´ä¸­çš„promiseï¼</p>
<p>å…³äºpromiseè¿™ä¸ªæ¦‚å¿µæˆ‘å‰å‰ååçœ‹äº†æœ‰ä¸€å¹´äº†ï¼Œå‘¨å›´ä¹Ÿæ²¡æœ‰è®¤è¯†çš„äººå¯ä»¥ç»™æˆ‘è®²ï¼Œåªèƒ½è‡ªå·±çœ‹çœ‹ç½‘ä¸Šçš„æ–‡ç« ï¼Œç„¶è€Œâ€¦<del>å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨</del>â€¦ç½‘ä¸Šçš„æ–‡ç« éƒ½æ˜¯ä¼—è¯´çº·çº­ï¼Œæœ‰ä¸€ä¸Šæ¥å°±deferçš„<a href="https://github.com/alsotang/node-lessons/tree/master/lesson17" target="_blank" rel="noopener">^1</a>ï¼Œä¹Ÿæœ‰ä¸€ä¸Šæ¥å°±è¯´å¦‚æœä½ è¿˜åœ¨ç”¨deferä½ å°±ç†è§£é”™äº†Promiseçš„<a href="http://web.jobbole.com/82601/" target="_blank" rel="noopener">^2</a>ï¼Œå°±æ‰€ä»¥æˆ‘åˆ°ç°åœ¨ä¹Ÿä¸çŸ¥é“ç©¶ç«Ÿä»€ä¹ˆæ ·çš„ç†è§£æ‰æ˜¯å¯¹çš„â€¦</p>
<p>å…³äº<a href="http://segmentfault.com/a/1190000002452115" target="_blank" rel="noopener">Promiseä»¥åŠA+è§„èŒƒ</a>å°±ä¸åœ¨æ­¤è¯¦è¿°äº†ï¼Œé‚£äº›æ¦‚å¿µçš„ä¸œä¸œï¼Œæˆ‘ä¹Ÿè¿˜æ²¡å®Œå…¨ç†è§£ã€‚æˆ‘æƒ³åšçš„æ˜¯è®©è·Ÿæˆ‘ä¸€æ ·çš„å°ç™½éƒ½èƒ½æ˜ç™½Promiseæœ€åŸºæœ¬çš„ç”¨æ³•ã€‚</p>
<hr>
<p>ä¸¾ä¸ªæ —å­â€¦<br>æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹æä¾›çš„APIï¼Œè®¿é—®APIèƒ½å¤Ÿå¾—åˆ°ä¸€äº›ç”¨æˆ·æ•°æ®ï¼ˆæ¯è®¿é—®ä¸€æ¬¡å¾—åˆ°ä¸€é¡µï¼Œå‡è®¾ç”±äºæŸäº›é™åˆ¶ä¸€é¡µåªè¿”å›3ä¸ªç”¨æˆ·ï¼‰ä»¥åŠä¸‹ä¸€é¡µçš„indexï¼›é™¤äº†ç¬¬ä¸€é¡µä¹‹å¤–ï¼Œå…¶ä»–çš„é¡µé¢éƒ½éœ€è¦ä¸‹ä¸€é¡µçš„indexå‚æ•°æ‰èƒ½è®¿é—®åˆ°ã€‚ï¼ˆå…ˆä¸ç®¡è¿™ä¸ªAPIè®¾è®¡çš„åˆä¸åˆç†â€¦Facebookå°±æœ‰è¿™æ ·çš„APIï¼‰<br><a href="http://example.com/user" target="_blank" rel="noopener">http://example.com/user</a>  <em>â€“&gt;è®¿é—®ç¬¬ä¸€é¡µçš„ç”¨æˆ·æ•°æ®</em><br><a href="http://example.com/user?next=xzmca" target="_blank" rel="noopener">http://example.com/user?next=xzmca</a>  <em>â€“&gt;è®¿é—®ç¬¬äºŒé¡µçš„ç”¨æˆ·æ•°æ®</em><br>è¯·æ±‚ç¬¬ä¸€é¡µæ—¶è¿”å›ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"items"</span> : [&#123;</span><br><span class="line">  <span class="attr">"name"</span> : <span class="string">"å°ç™½å¦¹å¦¹"</span>,</span><br><span class="line">   <span class="attr">"age"</span> : <span class="number">10</span></span><br><span class="line">  &#125;, </span><br><span class="line">  &#123;...&#125;,</span><br><span class="line">  &#123;...&#125;],</span><br><span class="line">"nextPage" : "xzmca",</span><br><span class="line">"lastPage" : null</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½ å¯èƒ½ä¼šæœ‰è¿™æ ·çš„éœ€æ±‚ï¼šä½ çš„APPä¸€æ¬¡éœ€è¦æ˜¾ç¤º6ä¸ªç”šè‡³æ›´å¤šä¸ªçš„ç”¨æˆ·æ•°æ®ã€‚è€Œæ ¹æ®ä¹‹å‰çš„APIï¼Œä¸€æ¬¡åªèƒ½æ‹¿åˆ°3ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆå°±åªèƒ½å‘å‡ºä¸¤æ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”<strong>ç¬¬äºŒæ¬¡è¯·æ±‚ä¾èµ–äºç¬¬ä¸€æ¬¡è¯·æ±‚çš„ç»“æœ</strong>ï¼Œç”±äºå¼‚æ­¥çš„åŸå› æˆ‘ä»¬å¹¶ä¸çŸ¥é“ç¬¬ä¸€ä¸ªè¯·æ±‚ä»€ä¹ˆæ—¶å€™æ‰å®Œæˆï¼Œ<del>è€Œæˆ‘æœ€åˆå…¥å‘æ—¶æ˜¯è®©ç¨‹åºå‘å®Œç¬¬ä¸€ä¸ªè¯·æ±‚åå¼ºåˆ¶ç­‰2ç§’å†å‘ç¬¬äºŒä¸ªè¯·æ±‚æˆ‘ä¼šå‘Šè¯‰ä½ ä»¬å—â€¦</del></p>
<p>ä¸‹é¢ä¸ºäº†æ–¹ä¾¿ï¼Œä½¿ç”¨<code>setTimeout()</code>å‡½æ•°å’Œ<a href="http://bluebirdjs.com/" target="_blank" rel="noopener">bluebird</a>åº“è¿›è¡Œè¯´æ˜:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”Ÿæˆä¸€ä¸ª0åˆ°3000çš„éšæœºæ•°ï¼Œæ¨¡æ‹Ÿä¸ç¡®å®šçš„ç­‰å¾…æ—¶é—´0-3ç§’</span></span><br><span class="line"><span class="keyword">var</span> randomTime = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() * <span class="number">3000</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åªè€ƒè™‘æœ€ç®€å•çš„æƒ…å†µpromiseè¢«resolveï¼Œæš‚æ—¶ä¸è€ƒè™‘promiseè¢«rejectçš„æƒ…å†µ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">req1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨setTimeout()æ¥æ¨¡æ‹Ÿå‘é€è¯·æ±‚ï¼Œdataä¸ºè¯·æ±‚å¾—åˆ°çš„æ•°æ®</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> data = &#123;</span><br><span class="line">        <span class="string">"items"</span>: [&#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å°ç™½å¦¹å¦¹"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">10</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å°ç™½"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">100</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å¦¹å¦¹"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">111</span></span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="string">"nextPage"</span>: <span class="string">"asdfa"</span>,</span><br><span class="line">        <span class="string">"lastPage"</span>: <span class="literal">null</span></span><br><span class="line">      &#125;;</span><br><span class="line">      resolve(data);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"è¯·æ±‚1å®Œæˆ"</span>);</span><br><span class="line">    &#125;, randomTime());</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">req2</span>(<span class="params">dataFromReq1</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> data = &#123;</span><br><span class="line">        <span class="string">"items"</span>: [&#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å°é»‘å§å§"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">20</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å°é»‘"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">233</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          <span class="string">"name"</span>: <span class="string">"å§å§"</span>,</span><br><span class="line">          <span class="string">"age"</span>: <span class="number">250</span></span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="string">"nextPage"</span>: <span class="string">"gwdfx"</span>,</span><br><span class="line">        <span class="string">"lastPage"</span>: <span class="string">"asdfa"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">console</span>.log(dataFromReq1);</span><br><span class="line">      <span class="keyword">var</span> finalUserData = dataFromReq1.items.concat(data.items); <span class="comment">//å°†ä¸¤æ¬¡å¾—åˆ°çš„ç”¨æˆ·æ•°æ®åˆå¹¶</span></span><br><span class="line">      resolve(finalUserData);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"è¯·æ±‚2å®Œæˆ"</span>);</span><br><span class="line">    &#125;, randomTime());</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®©æ•°æ®åœ¨promiseé“¾ä¸Šæ¬¢å¿«çš„ä¼ é€’å§ï½</span></span><br><span class="line">req1().then(req2).then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>Q: ä»€ä¹ˆæ—¶å€™éœ€è¦è¿”å›ä¸€ä¸ªpromiseå‘¢ï¼Ÿ<br>A: å½“ä½ çš„éœ€æ±‚é€»è¾‘æ˜¯ï¼ŒXXXçš„æ‰§è¡Œéœ€è¦ä¾èµ–OOOçš„ç»“æœï¼Œæ­¤æ—¶OOOå°±åº”è¯¥è¿”å›ä¸€ä¸ªpromise</p>
</li>
<li><p>Q: ä¸ºä»€ä¹ˆreq1è¦æ‰“æ‹¬å·ï¼Œè€Œreq2ä¸æ‰“æ‹¬å·ï¼Ÿ<br>A:è¿™ä¸ªæˆ‘ä¹Ÿæ²¡å¤ªææ¸…æ¥šXDï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼Œ<code>req1()</code>æ‰“æ‹¬å·æ‰§è¡Œåæ‰ä¼šè¿”å›promiseï¼Œä¸æ‰“æ‹¬å·å°±åªæ˜¯ä¸€ä¸ªæ²¡æœ‰æ‰§è¡Œçš„å‡½æ•°ï¼Œ<code>req2</code>ä¸æ‰“æ‹¬å·æ˜¯å› ä¸ºthençš„å…¥å‚åªèƒ½æ˜¯ä¸€ä¸ª<strong>å‡½æ•°</strong>ï¼Œå¦‚æœæ‰“äº†æ‹¬å·æ‰§è¡Œåå°±ä¸æ˜¯å‡½æ•°äº†ã€‚</p>
</li>
<li><p>Q: æœ€åä¸€ä¸ªthençš„function(data) dataæ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ<br>A: <code>req2</code>çš„å®šä¹‰ä¸­ï¼Œæœ‰ä¸€å¥<code>resolve(finalUserData)</code>ï¼Œåœ¨Promise Chainä¸­ï¼Œæ¯ä¸ªthençš„å…¥å‚çš„å…¥å‚ä¹Ÿå°±æ˜¯function(data)ä¸­çš„dataéƒ½æ˜¯ç”±å‰ä¸€ä¸ªpromise resolveæ—¶ä¼ é€’è€Œæ¥çš„</p>
</li>
</ul>

  </article>
</div>


    
<div class="container disqus-container">
  <div id="disqus_thread"></div>
</div>

<script>
  var disqus_config = function() {
    this.page.url = "https://sabrinaluo.github.io/tech/2015/12/01/promise/";
    this.page.identifier = 1448966786;
  };

  (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hiitea-tech.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>





</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <div class="clearfix">
    <a href="https://sabrinaluo.github.io/tech" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>Â© 2019 HiiTea</li>
      <li><a href="https://sabrinaluo.github.io/tech">Home</a></li>
      
      <li><a href="https://github.com/sabrinaluo">Github</a></li>
      
      <li><a href="http://weibo.com/206663121">Weibo</a></li>
      
    </ul>
    <div class="footer-theme-info">
      Theme <a href="//github.com/sabrinaluo/hexo-theme-replica">Replica</a>
      by <a href="//github.com/sabrinaluo">Hiitea</a> â¤ Powered by Hexo
    </div>
    </div>
    
    <div class="footer-pageview">
        <a href="https://info.flagcounter.com/mx4Y">
          <img src="//s01.flagcounter.com/count/mx4Y/bg_FFFFFF/txt_000000/border_FFFFFF/columns_3/maxflags_9/viewers_3/labels_0/pageviews_1/flags_0/percent_0/">
        </a>
    </div>
    
  </footer>
</div>


<script>
  (function() {
    var cx = '015579750388200492852:dnpv83myu4a';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>



<script src="/tech/js/main.js"></script>

</body>
</html>
